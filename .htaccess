# Apache Configuration for Property Management System

# Disable directory listing
Options -Indexes

# Enable Rewrite Engine
RewriteEngine On

# Set base path for subdirectory installations
RewriteBase /pm/

# Don't rewrite if the actual file exists (but allow directories to be rewritten)
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# Don't rewrite install, api, config, database, includes, assets directories
RewriteCond %{REQUEST_URI} ^/pm/(install|api|config|database|includes|assets)/
RewriteRule ^ - [L]

# If accessing root (/pm/), serve public/index.php
RewriteCond %{REQUEST_URI} ^/pm/?$
RewriteRule ^$ public/index.php [L]

# Redirect everything else to public directory (but not if already in public)
RewriteCond %{REQUEST_URI} !^/pm/public/
RewriteCond %{REQUEST_URI} ^/pm/
RewriteRule ^(.*)$ public/$1 [L]

# Security: Prevent direct access to config files
<FilesMatch "^(config|includes|database)">
    Order allow,deny
    Deny from all
</FilesMatch>

# Set default index file
DirectoryIndex index.php index.html

# Enable PHP error reporting (disable in production)
php_flag display_errors On
php_value error_reporting E_ALL

